
# Inštalácia Sublime text a pluginu packagecontrol

1. Prvným krokom po nainštalovaní poslednej verzie sublime text je inštálacia [**Package control**](https://packagecontrol.io/installation) 

2. Po jeho inštalácii *RESTART* sublime textu. Následne spustenie **Command palette**  
(win: ctr+shift+p, mac: command+shift+p)

3. napísať *install package*, objaví sa "package Control: Install Package" a následne napísať **REPL**

4. *RESTART*

5. Nastavenie layoutu v sublime text menu: `VIEW / LAYOUT / Columns:2`

6. Dať kurzor do pravého stĺpca a zapnúť **Command palette** (win: ctr+shift+p, mac: command+shift+p) a tam napísať **REPL** a z ponúknutých možností vybrať **sublimeREPL: R**. Týmto by sa mal spustiť interaktívny terminál nášho lokálneho R

##### POZNÁMKY:  

* je nutné pracovať so súborom typu .R v Sublime texte (vpravo dolu)

* teraz je možné v ľavom okne písať kód, napr: *hist(rnorm(100))*. Takže sa následne zobrazí okno s histogramom

* do repl sa pošle riadok kódu pomocou **ctrl+shift+r** (win) alebo **option+shift+r** (mac)

* cez menu je možné poslať príkazy nasledovne: *tools - sublimeREPL - transfer (eval) to repl - lines*

* v sublime texte sú 2 typy konfiguračných souborov, user a default. Nikdy needitovať default vždy len user, pretože default sa môže prepísať pri update

## KEY BINDINGS:

- zvoliť `MENU / PREFERENCES / KEY BINDINGS`

* vpravo by sa mal objaviť sublime - keymap -- User. Vložiť


```

[
        // R
        { "keys": ["alt+-"], "command": "insert_snippet", "args": {"contents": " <- " }},
        { "keys": ["shift+ctrl+/"], "command": "insert_snippet", "args": {"contents": "#' " }},

        // SublimeREPL
        { "keys": ["alt+shift+r"], "command": "repl_transfer_current", "args": {"scope": "file"}},

        { "keys": ["ctrl+shift+r"], "command": "repl_transfer_current", "args": {"scope": "lines"}},

        { "keys": ["ctrl+alt+r"], "command": "repl_transfer_current", "args": {"scope": "selection"}}
]
```

- **ctrl+shift+r**  je spustenie riadku, na ktorom je kurzor 
- **ctrl+alt+r** je spustenie výberu
- **alt+shift+r**  je spustenie celého skriptu
- ak sa umiestni kurzor do ľavého stĺpca a dá **ctrl+n**  (mac: **command+n** ), otvorí sa nový neuložený tab
- ak sa zadá **ctrl+shift+p** a potom napíše "syntax r" a potvrdí, tak potom keď sa zmačkne **alt + -** (alt a pomlčka), tak to urobí R-kovú šípku
- je tam ešte jedna custom skratka, **ctrl  + /**, ktorá urobí v kóde znak comment bez ohľadu na aktuálny jazyk
- príkaz **ctrl +  shift + /** urobí v R **#'** , to využívá roxygen2 (na písanie dokumentace v r)

  

#### KONVERZNÉ SKRATKY WIN-MAC PRÍKAZOV

[Skratky Win/Mac](https://www.lifewire.com/what-are-windows-keyboard-equivalents-to-mac-2260203)

MAC / WINDOWS:

Control - CTRL  
Option - Alt  



#### Tutorial:

Cez Command palette zadať Install package a dať hľadať Sublime tutor a dať nainštalovať.

[Sublime tutorial](https://sublimetutor.com/)


### SSH - generovanie prístupu pre MAC

**POZN:** MENOUSERA - nahradiť prideleným username od administrátora!

**POZN2:** Zobrazenie skrytých súborov na MacOS:**Command+Shift+.**

1. Vygenerovať si kľúč: [link](https://www.siteground.com/kb/how_to_generate_an_ssh_key_pair_in_mac_os/)
2. Pokiaľ sa používajú dva počítače, je nutné kľúč preniesť na druhý počítač.
(pozn: nachádza sa pod user/.ssh)


* `ssh MENOUSERA@82.113.61.179 -p 4994`
* zadať lokálne heslo na pripojenie

- Ak sa zadá MENOUSERA a enter, pustí to do zložky CODE a spustí midnight commandera (mc). MC sa zatvára pomocou F10 a SSH relácia sa zatvára pomocou **Ctrl + D** (mac: **Control + D**) 

#### Vytvorenie Aliasu
1. súbor **.bash_profile** (v prípade, že nie je, tak vytvoriť pomocou touch .bash_profile)
2. do súboru pridať:
`alias Rengine='ssh MENOUSERA@82.113.61.179 -p 4994'`,
uložiť a zavrieť

3. Znovu otvoriť nový terminál a SSH sa spustí zadaním **Rengine**


### Sprístupnenie sieťovej zložky

**POZN:** MENOUSERA - nahradiť prideleným username od administrátora!

1. Vytvoriť v home adresár `InferenceTech/Rengine`

2. Nainštalovať [Fuse for Mac a SSHFS](https://osxfuse.github.io)

3. V termináli 
`sshfs -p 4994 MENOUSERA@82.113.61.179:/stor/a01/  ~/InferenceTech/Rengine/`

4. Mal by sa nazdielať disk z Rengine do adresára `InferenceTech/Rengine` a ukazuje OSXFUSE ako namountovaný

5. Na odpojenie:  
 `umount ~/InferenceTech/Rengine/`
 - teraz je možné, že bude adresár prázdny

 6. `sshfs -o defer_permissions -p 4994 ronek@82.113.61.179:/stor/a01/  ~/InferenceTech/Rengine/`


#### Vytvorenie Aliasu

Do súbora **bash_profile** vložiť znova aliasy

```
alias mRengine='sshfs -o defer_permissions -p 4994 MENOUSERA@82.113.61.179:/stor/a01/  ~/InferenceTech/Rengine/ '
alias uRengine='umount ~/InferenceTech/Rengine/'
```

Potom sa to používa tak, že sa zapne terminál, disk se pripojí pomocou Rengine (aka mount Rengine), odpojí pomocou uRengine, ssh Rengine. Čiže mRengine pripojí disk na Rengine do lokálnej zložky užívateľa `~/InferenceTech/Rengine/`

### Nastavenie forwardovania X11

1. Ísť do adresára: `~/Library/Application Support/Sublime Text 3/Packages/SublimeREPL/config/R`

2. Vytvoriť na tej istej úrovni adresár Rengine `~/Library/Application Support/Sublime Text 3/Packages/SublimeREPL/config/Rengine` a do neho vkopírovať dva súbory zo zložky R: `Default.sublime-commands` a `Main.sublime-menu`

### Úprava súboru `Default.sublime-commands` v rámci adresára Rengine

Na dvoch miestach nahradiť **R** za **Rengine** (pre caption a file)
a **repl_r** na **repl_rengine** (pre id)

```
[
    {
        "caption": "SublimeREPL: Rengine",
        "command": "run_existing_window_command", "args":
        {
            "id": "repl_rengine",
            "file": "config/Rengine/Main.sublime-menu"
        }
    }
]
```

### Úprava súboru `Main.sublime-menu` v rámci adresára Rengine

1. Upraviť pre cmd - osx hranaté zátvorky nasledovne: 
```
"osx": ["ssh","-XC","-p 4994","MENOUSERA@82.113.61.179","R", "--interactive", "--no-readline", "--no-save"]
```

takže to bude vyzerať nasledovne:

```
   "cmd": {"linux": ["R", "--interactive", "--no-readline"],
                            "osx": ["R", "--interactive", "--no-readline"],
                            "windows": ["Rterm.exe", "--ess", "--encoding=$win_cmd_encoding"]},
```
2. Vykonať ešte 3 zámeny **R** za **Rengine**, aby to vyzeralo nasledovne:

```
{"command": "repl_open",
                 "caption": "Rengine",
                 "id": "repl_rengine",
                 "mnemonic": "Rengine",
 ...
```

#### Test X11 forwardovania

1. Sublime text
2. Pre MAC môže byť potrebné najprv zavolať `ssh-add ~/.ssh/id_rsa`
3. V pravom okne zadať `ctrl + shift + p` a napísať **repl ren** (bude to vidieť ako SublimeREPL: Rengine)
4. test: napísať v ľavom okne (súbor typu R) hist(rnorm(100)) a poslať to do replu (win: ctrl+shift+r, mac: option+shift+r)

*pozn.* V prípade problémov s právami nastaviť:
```
chmod 600 ~/.ssh/id_rsa
chmod 644 ~/.ssh/id_rsa.pub
chmod 644 ~/.ssh/known_hosts
chmod 700 ~/.ssh
```

#### XQUARTZ
**POZN.** Pokiaľ nezobrazuje histogram, nainštalovať [Xquartz](https://www.xquartz.org). Po jeho nainštalovaní je nutný reštart počítača.

#### Vypnutie Autocomplete v repl okne

`Preferences->Package settings->SublimeREPL->Settings-User`

a vložiť:

```
{
        "repl_view_settings": {
                "translate_tabs_to_spaces": false,
                "auto_indent": false,
                "smart_indent": false,
                "spell_check": false,
                "indent_subsequent_lines": false,
                "detect_indentation": false,
                "auto_complete": false,
                "line_numbers": false,
                "gutter": false
        },

}
```









































